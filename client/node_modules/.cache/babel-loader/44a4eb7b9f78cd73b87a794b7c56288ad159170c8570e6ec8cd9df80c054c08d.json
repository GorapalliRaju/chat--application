{"ast":null,"code":"import _toConsumableArray from\"C:/Users/gorapalli raju/chat-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/gorapalli raju/chat-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import io from'socket.io-client';import{useLocation}from'react-router-dom';import'./chat.css';import InfoBar from'../infoBar/infoBar';import Input from'../input/input.js';import Messages from'../messages/messages.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var socket=io('http://localhost:5000');// Move it outside the component\nfunction Chat(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var location=useLocation();useEffect(function(){var data=new URLSearchParams(location.search);var name=data.get('name');var room=data.get('room');setName(name);setRoom(room);socket.emit('join',{name:name,room:room},function(error){if(error){console.error(error);}});return function(){socket.disconnect();};},[location.search]);useEffect(function(){socket.on('message',function(message){setMessages(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[message]);});});return function(){socket.off('message');};},[]);var sendMessage=function sendMessage(event){event.preventDefault();if(message){socket.emit('sendMessage',message,function(){return setMessage('');});}};console.log(message,messages);return/*#__PURE__*/_jsx(\"div\",{className:\"outerContainer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"innerContainer\",children:[/*#__PURE__*/_jsx(InfoBar,{room:room}),/*#__PURE__*/_jsx(Messages,{messages:messages,name:name}),/*#__PURE__*/_jsx(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage})]})});}export default Chat;","map":{"version":3,"names":["React","useState","useEffect","io","useLocation","InfoBar","Input","Messages","jsx","_jsx","jsxs","_jsxs","socket","Chat","_useState","_useState2","_slicedToArray","name","setName","_useState3","_useState4","room","setRoom","_useState5","_useState6","message","setMessage","_useState7","_useState8","messages","setMessages","location","data","URLSearchParams","search","get","emit","error","console","disconnect","on","prevMessages","concat","_toConsumableArray","off","sendMessage","event","preventDefault","log","className","children"],"sources":["C:/Users/gorapalli raju/chat-app/client/src/components/chat/chat.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport io from 'socket.io-client';\r\nimport { useLocation } from 'react-router-dom';\r\nimport './chat.css';\r\nimport InfoBar from '../infoBar/infoBar';\r\nimport Input from '../input/input.js';\r\nimport Messages from '../messages/messages.js';\r\nconst socket = io('http://localhost:5000'); // Move it outside the component\r\n\r\nfunction Chat() {\r\n  const [name, setName] = useState('');\r\n  const [room, setRoom] = useState('');\r\n  const [message, setMessage] = useState('');\r\n  const [messages, setMessages] = useState([]);\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    const data = new URLSearchParams(location.search);\r\n    const name = data.get('name');\r\n    const room = data.get('room');\r\n    \r\n    setName(name);\r\n    setRoom(room);\r\n\r\n    socket.emit('join', { name, room }, (error) => {\r\n      if(error){\r\n        console.error(error);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect(); \r\n    };\r\n  }, [location.search]);\r\n\r\n  useEffect(() => {\r\n    socket.on('message', (message) => {\r\n      setMessages(prevMessages => [...prevMessages, message]);\r\n    });\r\n\r\n    return () => {\r\n      socket.off('message');\r\n    };\r\n  }, []); \r\n\r\n  const sendMessage = (event) => {\r\n    event.preventDefault();\r\n    if (message) {\r\n      socket.emit('sendMessage', message, () => setMessage(''));\r\n    }\r\n  };\r\n\r\n  console.log(message, messages);\r\n\r\n  return (\r\n    <div className=\"outerContainer\">\r\n      <div className=\"innerContainer\">\r\n        <InfoBar room={room}/>\r\n        <Messages messages={messages} name={name}/>\r\n        <Input message={message} setMessage={setMessage} sendMessage={sendMessage} />\r\n        </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}